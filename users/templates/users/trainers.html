{% extends 'users/staff_dashboard.html' %}
{% load custom_filters %}
{% load static %}

{% block content %}
<div class="container mt-5">

    <!-- Page Title -->
    <h1 class="text-center" style="color: #5f52aa;">Trainer List</h1>

    <!-- Responsive Table Section -->
    <div class="table-responsive">
        <table class="table table-striped table-bordered shadow-sm">
            <thead style="background-color: #5f52aa; color: white;">
                <tr>
                    <th scope="col">Trainer Name</th>
                    <th scope="col">Asanas Created</th>
                    <th scope="col">Courses Created</th>
                    <th scope="col">Enrollments</th>
                    <th scope="col" class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for trainer in trainers %}
                <tr>
                    <td>{{ trainer.trainer_name.username }}</td>
                    <td>{{ trainer.no_of_asanas_created }}</td>
                    <td>
                        <ol class="list-unstyled">
                            {% for course in trainer_courses|get_item:trainer.trainer_name.id %}
                                <li>{{ course.course_name }}</li>
                            {% empty %}
                                <li class="no-content">No courses created by this trainer.</li>
                            {% endfor %}
                        </ol>
                    </td>
                    <td>
                        <ol class="list-unstyled">
                            {% for enrollment in trainer_enrollments|get_item:trainer.trainer_name.id %}
                                <li>{{ enrollment.user.username }} enrolled - {{ enrollment.students_added_to_courses.all|join:", " }}</li>
                            {% empty %}
                                <li class="no-content">No enrollments for this trainer.</li>
                            {% endfor %}
                        </ol>
                    </td>
                    <td>
                        <div class="d-flex justify-content-center">
                            <!-- Enable/Disable Button Forms -->
                            <form id="enable-form-{{ trainer.trainer_name.id }}" method="POST" style="display:inline;">
                                {% csrf_token %}
                                <input type="hidden" name="trainer_id" value="{{ trainer.trainer_name.id }}">
                                <input type="hidden" name="action" value="enable">
                                {% if not trainer.is_active %}
                                    <button type="submit" class="btn btn-success btn-sm">Enable</button>
                                {% endif %}
                            </form>

                            <form id="disable-form-{{ trainer.trainer_name.id }}" method="POST" style="display:inline;">
                                {% csrf_token %}
                                <input type="hidden" name="trainer_id" value="{{ trainer.trainer_name.id }}">
                                <input type="hidden" name="action" value="disable">
                                {% if trainer.is_active %}
                                    <button type="submit" class="btn btn-danger btn-sm">Disable</button>
                                {% endif %}
                            </form>

                            <!-- Edit button remains unchanged -->

                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center">No trainers available.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Back Button -->
    <div class="d-flex justify-content-center mt-4">
        <a href="{% url 'Trainer-approval' slug=tenant.slug %}" class="btn btn-primary btn-lg" style="background-color: #5f52aa; border-color: #5f52aa;">
            Back to Dashboard
        </a>
    </div>

</div>

{% endblock %}

